<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico.png') }}" type="image/x-icon">
    <title>Court-Data Fetcher & Mini-Dashboard</title>
    <style>
        .custom-title {
            font-weight: bold;
            color: #002d72;
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #fffff0;
            padding-top: 10px;
        }
        .form-box {
            background-color: #008080;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(0,0,0,1);
            max-width: 900px;
            margin: auto;
        }
        .case-card {
            border-left: 5px solid #002d72;
            padding: 20px;
            margin-top: 20px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,1);
        }
        .custom-title {
        font-weight: bold;
        color: #002d72;
    }
    .container label {
        font-weight: bold;
        color: #111;
    }
    </style>
</head>
<body>
            <h2 class="text-center mb-4 custom-title">Court-Data Fetcher & Mini-Dashboard</h2>

<div class="container">
    <div class="form-box">
        <form method="POST">
            <div class="mb-3">
                <label for="court_complex" class="form-label">Court Complex</label>
                <select name="court_complex" class="form-select" required>
                    <option value="">Select Court Complex</option>
                    <option value="Court of Judicial Magistrate of First Class, Kurupam (Taluka)">Court of Judicial Magistrate of First Class, Kurupam (Taluka)</option>
                    <option value="Court of Junior Civil Judge,, Cheepurupalli (Taluka)">Court of Junior Civil Judge,, Cheepurupalli (Taluka)</option>
                    <option value="Court of Senior Civil Judge,, Bobbili (Taluka)">Court of Senior Civil Judge,, Bobbili (Taluka)</option>
                    <option value="Court of Junior Civil Judge,, Srungavarapukota (Taluka)">Court of Junior Civil Judge,, Srungavarapukota (Taluka)</option>
                    <option value="Court of Junior Civil Judge,, GajapathiNagaram (Taluka)">Court of Junior Civil Judge,, GajapathiNagaram (Taluka)</option>
                    <option value="Court of Junior Civil Judge,, Kothavalasa (Taluka)">Court of Junior Civil Judge,, Kothavalasa (Taluka)</option>
                    <option value="Court of Junior Civil Judge,, Salur (Taluka)">Court of Junior Civil Judge,, Salur (Taluka)</option>
                    <option value="II Additional District Court,PVP">II Additional District Court,PVP</option>
                    <option value="PDJ Court VIZIANAGARAM">PDJ Court VIZIANAGARAM</option>
                </select>
            </div>
            <div class="mb-3">
    <label for="case_type" class="form-label">Case Type</label>
    <select name="case_type" class="form-select">
        <option value="">-- Select Case Type (optional) --</option>
        <option value="CC">CC - Calendar Case</option>
        <option value="EP">EP - Execution Petition</option>
        <option value="OS">OS - Original Suit</option>
    </select>
</div>

            <div class="mb-3">
    <label for="case_number" class="form-label">Case Number <span class="text-danger">*</span></label>
    <input type="text" name="case_number" class="form-control" required>
</div>

  <div class="mb-3">
    <label for="filing_year" class="form-label">Filing Year <span class="text-danger">*</span></label>
    <select name="filing_year" id="filing_year" class="form-select" required onfocus="this.size=6;" onblur="this.size=1;" onchange="this.size=1; this.blur();">
        <option value="">-- Select Year --</option>
    </select>
   <input type="text" class="form-control mt-2" placeholder="Or enter manually" oninput="document.getElementById('filing_year').value=this.value;">

  </div>

            <div class="mb-3">
    <label class="form-label">Captcha</label>
    <div class="d-flex align-items-center">
        <img src="{{ captcha_url }}" alt="CAPTCHA" id="captcha-img" style="height: 80px; margin-right: 30px;">
        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="refreshCaptcha()" title="Reload CAPTCHA">
            ðŸ”„
        </button>
    </div>
    <input type="text" name="captcha" class="form-control mt-2" required>
</div>

            <div class="text-center">
                <button type="submit" class="btn" style="background-color: #002d72; color: #fff;">Search</button>
                <button type="reset" class="btn" style="background-color: #002d72; color: #fff;" onclick="window.location.reload()">Reset</button>
            </div>
        </form>

        {% if error %}
  <div class="alert alert-danger mt-4" id="error-box">Error: {{ error }}</div>
{% endif %}


        {% if case_list %}
            <h5 id="results" class="mt-5">Matched Cases:</h5>
            {% for case in case_list %}
                <div class="case-card">
                    <p><strong>Case Number:</strong> {{ case.case_number }}</p>
                    <p><strong>Parties:</strong> {{ case.parties }}</p>
                    <p><strong>Filing Date:</strong> {{ case.filing_date }}</p>
                    <p><strong>Status:</strong> {{ case.case_status }}</p>
                    <p><strong>Next Hearing:</strong> {{ case.next_hearing_date }}</p>
                    <p><strong>PDF:</strong>
                        {% if case.pdf_link != "No PDF available" %}
                            <a href="{{ case.pdf_link }}" target="_blank">Download PDF</a>
                        {% else %}
                            No PDF Available
                        {% endif %}
                    </p>
                </div>
            {% endfor %}
        {% endif %}
    </div>
</div>
<script>
    function refreshCaptcha() {
        window.location.href = "/";
    }

    window.onload = function () {
        const errorBox = document.getElementById("error-box");
        const resultsSection = document.getElementById("results");

        if (errorBox) {
            errorBox.scrollIntoView({ behavior: "smooth" });
        } else if (resultsSection) {
            resultsSection.scrollIntoView({ behavior: "smooth" });
        }
    };
    // Populate Filing Year Dropdown (last 30 years)
  const select = document.getElementById("filing_year");
  const currentYear = new Date().getFullYear();
  for (let i = 0; i < 30; i++) {
    const year = currentYear - i;
    const option = document.createElement("option");
    option.value = year;
    option.text = year;
    select.appendChild(option);
  }
</script>
</body>
</html>
